#
# This action checks PRs to see if any docs files were updated.
# If none were, it will add a message to the PR asking if it would make sense to do so.
#
name: Docs Check

on: pull_request

jobs:
  docs-checker:
    # For security reasons, GITHUB_TOKEN is read-only on forks, so we cannot leave comments on PRs.
    # This check skips the job if it is detected we are running on a fork.
    if: ${{ github.event.pull_request.head.repo.full_name == 'smartcontractkit/integrations-framework' }}
    name: Docs Checker
    runs-on: ubuntu-latest
    steps:
      - name: Check for changed files
        id: changedfiles
        uses: umani/changed-files@1d252c611c64289d35243fc37ece7323ea5e93e1 # Version 3.3.0
        with:
          repo-token: ${{ secrets.GITHUB_TOKEN }}
          pattern: '^docs/.*$'
      - name: Make a comment
        uses: unsplash/comment-on-pr@ffe8f97ccc63ce12c3c23c6885b169db67958d3b # Version v1.2.0
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        if: steps.changedfiles.outputs.files_updated == "" && steps.changedfiles.outputs.files_created != ""
        with:
          msg: "I see that you haven't updated any `docs/` files. Will this PR change or add functionality that should be documented?"
          check_for_duplicate_msg: true
